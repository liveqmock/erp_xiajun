<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wangqin.mapper.PurchaseStorageMapper">

   <!-- 通用查询结果列-->
    <sql id="Base_Column_List">
    id,buyer_name AS buyerName,buyer_id AS buyerId,sto_order_no AS stoOrderNo,gmt_create AS gmtCreate,gmt_modify AS gmtModify,user_create AS userCreate,user_modify AS userModify,warehouse_id AS warehouseId,warehouse_name AS warehouseName,`status`,storage_type AS storageType,put_in_date AS putInDate,remark as remark
    </sql>

	<select id="queryPurStoragesCount" resultType="java.lang.Integer"  parameterType="com.wangqin.vo.PurchaseStorageVO">
        SELECT
        	count(1)
        FROM
            purchase_storage T1
        where
     		   1=1
            <if test="buyerId != null and buyerId != '' ">
               and T1.buyer_id = #{buyerId}
            </if>
            <if test="stoOrderNo != null and stoOrderNo != '' ">
               and T1.sto_order_no = #{stoOrderNo}
            </if>
            <if test="warehouseId != null and warehouseId != '' ">
               and T1.warehouse_id = #{warehouseId}
            </if>
            <if test="status != null">
               and T1.status = #{status}
            </if>
            <if test=" startTime != null ">
             and   <![CDATA[  T1.gmt_create >= #{startTime} ]]>
            </if>
            <if test=" endTime != null ">
            and    <![CDATA[  T1.gmt_create <= #{endTime} ]]>
            </if>
            <if test=" putInStart != null ">
             and   <![CDATA[  T1.put_in_date >= #{putInStart} ]]>
            </if>
            <if test=" putInEnd != null ">
            and    <![CDATA[  T1.put_in_date <= #{putInEnd} ]]>
            </if>
    </select>
    
    <select id="queryPurStorages" resultType="com.wangqin.model.purchase.PurchaseStorage" parameterType="com.wangqin.vo.PurchaseStorageVO">
        SELECT
        	 <include refid="Base_Column_List" />
       FROM
            purchase_storage T1
        where
     		   1=1
            <if test="buyerId != null and buyerId != '' ">
               and T1.buyer_id = #{buyerId}
            </if>
            <if test="stoOrderNo != null and stoOrderNo != '' ">
               and T1.sto_order_no = #{stoOrderNo}
            </if>
            <if test="warehouseId != null and warehouseId != '' ">
               and T1.warehouse_id = #{warehouseId}
            </if>
            <if test="status != null ">
               and T1.status = #{status}
            </if>
            <if test=" startTime != null ">
             and   <![CDATA[  T1.gmt_create >= #{startTime} ]]>
            </if>
            <if test=" endTime != null ">
            and    <![CDATA[  T1.gmt_create <= #{endTime} ]]>
            </if>
            <if test=" putInStart != null ">
             and   <![CDATA[  T1.put_in_date >= #{putInStart} ]]>
            </if>
            <if test=" putInEnd != null ">
            and    <![CDATA[  T1.put_in_date <= #{putInEnd} ]]>
            </if>
          order by T1.id desc
          	<![CDATA[ LIMIT #{firstStart},#{pageSize} ]]>
            
    </select>

</mapper>