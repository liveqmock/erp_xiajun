<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wangqin.mapper.ShippingTrackMapper">
	<!-- 通用查询结果列-->
    <sql id="Base_Column_List">
		T1.id, T1.shipping_no as shippingNo, T1.logistic_no as logisticNo, T1.status, T1.receive_time as receiveTime, T1.oversea_in_time as overseaInTime, T1.oversea_out_time as overseaOutTime,
		T1.oversea_on_transfer_time as overseaOnTransferTime, T1.inland_in_time as inlandInTime, T1.inland_out_time as inlandOutTime, T1.buyer_sign_time as buyerSignTime, T1.inland_express_id as inlandExpressId,
		T1.inland_express_no as inlandExpressNo,T1.weight, T1.volume, T1.totalfee, T1.air_take_off as airTakeOff, T1.airlines, T1.flight, T1.master_waybill_no as masterWaybillNo, T1.api_order_type as apiOrderType,
		T1.gmt_create as gmtCreate, T1.gmt_modify as gmtModify,T1.info 
	</sql>
	
	
	<select id="queryShippingTrack" resultType="com.wangqin.model.ShippingTrack" parameterType="java.lang.String"  >
        SELECT 
           <include refid="Base_Column_List" />
        FROM shipping_track T1 
        WHERE T1.shipping_no=#{shippingNo}
    </select>
    <select id="queryStatus" resultType="com.wangqin.model.ShippingTrack" >
       SELECT  
           T1.id, T1.shipping_no as shippingNo, T1.logistic_no as logisticNo, T1.status,T1.inland_express_id as inlandExpressId,T1.inland_express_no as inlandExpressNo
       FROM shipping_track T1
       LEFT JOIN shipping_order b ON T1.shipping_no = b.shipping_no
       WHERE b.status != 2 AND T1.status = 4 AND T1.inland_express_no is not null AND b.logistic_company!='海狐' 
       ORDER by T1.id DESC 
       LIMIT 2000
    </select>
    
    <update id="updateInfo" parameterType="java.lang.String" >
       UPDATE shipping_track T1 SET T1.info =#{0} WHERE T1.shipping_no=#{1} and T1.status = 4
    </update>
</mapper>
